/////para ustilizar este script hay que poner en el html:
/*
<!--*********para poder buscar si el usuario tiene o no instalado el pluggin(lo ultimo es la id de la app)***********-->

<!---ID DEL USUARIO QUE DEBE SER UNICO Y NUMERICO -->
<?php $Id_user_unique = $usuario['idusu']; ?>

<!--detecta si es windows o mac-->
<?php
$user_agent = getenv("HTTP_USER_AGENT");
if(strpos($user_agent, "Win") !== FALSE)
$os = "Windows";
elseif(strpos($user_agent, "Mac") !== FALSE)
$os = "Mac"; //para linux hace lo mismo que en mac
?>

<!--esto va en el header-->
<!--*********para poder buscar si el usuario tiene o no instalado el pluggin(lo ultimo es la id de la app)***********-->
<!--este tiene que ir en el header afuerzas-->
<link rel="chrome-webstore-item"
    href="https://chrome.google.com/webstore/detail/gcfkfapjkkjeocbjmnocphnljfncligl">
<!--***********************************************************************************************************************-->

<?php
$ua = $_SERVER["HTTP_USER_AGENT"];      // Get user-agent of browser
$chrome = strpos($ua, 'Chrome') ? true : false;             // Browser is Chrome
///si es chrome esta variable va ser true
?>

<?php if($chrome){ ?>
<!--check if chrome extension is installed -->
<center><button  class="button_round"  onclick="chrome.webstore.install(); " id="install-button">Install chrome extension</button></center>
<?php } ?>

<button class="button_round" type="button" id="recover_briko">Recover</button>
<button class="button_round" type="button" id="button_reset">Reset</button>
<button class="button_round"  type="button" id="button_load">Upload</button>
<button class="button_round"  type="button" id="button_search">Search</button>
<select id="port_picker"></select>
<div id="container_bar" style="width:100px; height:20px; border:1px solid black;float:right;margin-right: 5px;margin-left: 5px;">
<div id="progress-bar" style="width:0%; background-color:#008CBA ; height:20px;">
</div>
</div>
<center><p id="alert-message" style='color:#ff0000;font-weight: bold;'></p></center>
<p style="float:right;margin-top: 0px;margin-bottom: 0px;margin-right: 5px;margin-left: 5px;"class="h1classbk2" id="status_var">Programando</p>
<textarea id="content_brikode" class="content" readonly wrap="off"></textarea>
*/


if (!(typeof texts_array !== 'undefined')) {  //si la variable no esta definida(la cual debe ser definida donde ponemos el script para traerlo todo de la base de datos)
    var texts_array = new Array();
    texts_array[0]= "Por favor actualiza la pÃ¡gina antes de utilizar brikoblocks.";
    texts_array[1]= "Programando";
    texts_array[2]= "Tu briko se esta reseteando o esta cargando un programa por favor espera a que termine.";
    texts_array[3]= "Buscando";
    texts_array[4]= "Reseteando";
    texts_array[5]= "No has seleccionado un puerto, por favor utiliza el boton de buscar y selecciona un puerto antes de continuar.";
    texts_array[6]= "Compilando";
    texts_array[7]= "Reseteado";
    texts_array[8]= "<span style='color:#66AC43'>Reseteado con Ã©xito.</span>";
    texts_array[9]= "Error conectandose al servidor, por favor intenta nuevamente mas tarde.";
    texts_array[10]= "Error obteniendo informaciÃ³n del servidor, por favor intenta nuevamente mas tarde.";
    texts_array[11]= "Cargando";
    texts_array[12]= "Cargado";
    texts_array[13]= "<span style='color:#66AC43'>Cargado con Ã©xito.</span>";
    texts_array[14]= "Error con tu cuenta de briko, por favor comunicate con briko para solucionar tu problema.";
    texts_array[15]= "Error cargando el programa, por favor checa tu programa y intentalo nuevamente.";
    texts_array[16]= "Por favor actualiza la extension de chrome de briko antes de continuar.";
    texts_array[17]= "Por favor instala la extension de chrome de briko antes de continuar.";
    texts_array[18]= 'Por favor espera a que brikoblocks acabe antes de cambiar de ventana.';
    texts_array[19]= "Brikoblocks aun esta realizando algun proceso, Â¿Seguro quieres cerrar la ventana? ";
    texts_array[20]= 'Actualiza la extenciÃ³n de chrome';
    texts_array[21]= "Error enviando la informaciÃ³n al briko, por favor intentalo nuevamente.";
}

var hex_codigo_vacio = ":100000000C946E010C94D8070C9405080C943208DB:100010000C945F080C9496010C9496010C948C0837:100020000C9496010C9496010C94DD040C94A90395:100030000C9496010C9496010C9496010C949601E4:100040000C9496010C9496010C9496010C949601D4:100050000C9496010C9496010C9496010C94B9089A:100060000C9496010C94910E0C94C30E0C94960172:100070000C9496010C9496010C9496010C949601A4:100080000C9496010C9496010C9496010C94960194:100090000C94130B0C9496010C9496010C949601FD:1000A0000C9496010C9496010C949601BC09BF091E:1000B000AE09B209B809E009E009E009C309C709B6:1000C000CB09D109D509E009DB0900C18081C11242:1000D00001000202000040412336800001010200BD:1000E000011201000200000040412336800001019E:1000F00002000141726475696E6F204C4C430055DB:10010000534220494F20426F617264000403090486:100110000000000200090F0000030401000C0000B1:1001200000000000000000000000000000000408C3:1001300002011040804010204080408008020401ED:10014000804020100201108010204040040404046C:10015000040304050202020204030202020206066C:100160000606060604040202020400000000230042:10017000260029002C002F00000000002500280088:100180002B002E00310000000000240027002A0070:100190002D003000080B00020202010009040000DB:1001A00001020200000524001001052401010104E0:1001B00024020605240600010705810310004009FA:1001C000040100020A0000000705020240000007C7:1001D00005830240000000000000000000002A2B00:1001E00028000000000000000000000000000000E7:1001F0000000000000002C9EB4A0A1A2A434A6A779:10020000A5AE362D3738271E1F2021222324252670:10021000B333B62EB7B89F8485868788898A8B8C3E:100220008D8E8F909192939495969798999A9B9C86:100230009D2F3130A3AD350405060708090A0B0CC4:100240000D0E0F101112131415161718191A1B1C66:100250001DAFB1B0B50009040200010300000009A0:10026000210101000122650007058403400001050A:10027000010902A1010901A100850105091901294E:10028000031500250195037501810295017505810E:100290000305010930093109381581257F75089555:1002A000038106C0C005010906A1018502050719E1:1002B000E029E71500250175019508810295017572:1002C000088103950675081500256505071900299D:1002D000658100C08407FD0C500EF30E11241FBE73:1002E000CFEFDAE0DEBFCDBF11E0A0E0B1E0E8E49F:1002F000F0E202C005900D92AA34B107D9F723E0CD:10030000AAE4B1E001C01D92A332B207E1F712E006:10031000CCEDD2E004C02297FE010E941E10C43D25:10032000D107C9F70E949A010C9419100C9400008F:10033000089508950E944E090E9499018AE491E06F:100340000E9433050E948305C3E6DFE00E94980106:100350002097E1F30E94630FF9CF40914E01509135:100360004F0120914C0130914D0142175307B4F4D5:100370009091E8009570E1F39091E80092FD19C02A:100380008093F10080914E0190914F0101968F73FF:100390009927892B19F48EEF8093E80080914E0104:1003A00090914F01019690934F0180934E0181E00F:1003B000089580E00895CF92DF92FF920F931F93EC:1003C000CF93DF931F92CDB7DEB7082F162F862F5E:1003D000880F8E5F99830E94AD0183E00E94AD017A:1003E000F02EC02E9981D92E8C2D8F19811778F47B:1003F000F60184910E94AD01082F80E00E94AD01BA:100400008023FFEFCF1ADF0A8111EECF01C081E018:100410000F90DF91CF911F910F91FF90DF90CF90C0:100420000895615030F02091F100FC012083019685:10043000F8CF289884E68093510108952FB7FC01E6:100440002083F89467706093E9000895CF93DF9359:100450001F92CDB7DEB7682FCE0101960E941E0213:100460008091F20099819FBF0F90DF91CF91089505:10047000FF920F931F93CF93DF9300D0CDB7DEB7DA:10048000F62E8A0190915001992311F057FF03C075:100490008FEF9FEF2BC0682FCE0101967A830E94C9:1004A0001E028091F20090E0A8017A8180179107E6:1004B0000CF4AC01EF2DF72FF40E84E6FE1639F0A4:1004C0002898809351019091F1009193F7CF4115B5:1004D000510521F08091F200882321F089818FBF9E:1004E000CA0104C08BE68093E800F8CF0F900F900C:1004F000DF91CF911F910F91FF900895CF93DF93DC:100500001F92CDB7DEB741E050E0BE016F5F7F4F75:100510000E943802019719F4898190E002C08FEFA0:100520009FEF0F90DF91CF910895CF93DF931F92AC:10053000CDB7DEB7682FCE0101960E941E029091C2:10054000E800892F807295FF04C09091F20080E44A:10055000891B99819FBF0F90DF91CF9108956F9272:100560007F928F929F92AF92BF92CF92DF92EF9243:10057000FF920F931F93CF93DF931F92CDB7DEB7F8:10058000782E7B01C42EB52E80915001882369F00E:10059000042F152F8AEFD82E872D8072982E9AE37C:1005A000A92E872D8074882E11C08FEF9FEF57C022:1005B000872D0E949502682E81110CC0DA94A9F350:1005C00061E070E080E090E00E94260901151105CD:1005D00079F73BC0282F30E0021713070CF4602E88:1005E000672DCE0101960E941E028091E80085FFD2:1005F00029C0262D30E0021B130B992039F06A9494:100600008FEF6816B1F01092F100F9CFF701862D47:1006100077FE07C0815058F094919093F100319685:10062000F9CF815020F091919093F100FACFE20E32:10063000F31E8091E80085FF0FC00115110511F42C:1006400081100AC089818FBFC1CF5D9884E68093F5:1006500052018C2D9B2D03C0A092E800F3CF0F9088:10066000DF91CF911F910F91FF90EF90DF90CF908E:10067000BF90AF909F908F907F906F900895109251:10068000E90010924F0110924E0190934D0180931A:100690004C010895CF92DF92FF920F931F93CF9357:1006A000DF9300D0CDB7DEB7F82E8A016B010115BC:1006B0001105B1F0F601F7FE02C0849101C08081FE:1006C00049835A830E94AD0101501109FFEFCF1AEF:1006D000DF0A49815A818111EACF8FEF9FEF01C074:1006E000CA010F900F90DF91CF911F910F91FF9052:1006F000DF90CF9008951F93CF93DF931F92CDB7D4:10070000DEB7162F2091E80022FFFCCF612F7983FE:100710000E9411028BEF8093E800812F7981972F3F:100720000F90DF91CF911F910895CF93DF931F9288:10073000CDB7DEB71982CE0101960E949D0CCE0185:1007400001960E94380D898190E00F90DF91CF9142:1007500008951F920F920FB60F921124EF92FF92FD:100760000F931F932F933F934F935F936F937F93B9:100770008F939F93AF93BF93EF93FF93CF93DF93A9:10078000CDB7DEB76297DEBFCDBF1092E900809192:10079000E80083FFEBC068E0CE010A960E941102D8:1007A00082EF8093E8009A8597FF05C08091E8006A:1007B00080FFFCCF03C08EEF8093E800892F807606:1007C00009F0B9C08B85811105C01092F10010921B:1007D000F100C5C0282F2D7F213009F4C0C085301D:1007E00049F48091E80080FFFCCF8C85806880937D:1007F000E300B5C0863009F076C02D85E888F98819:10080000223071F580E090E02A8B0E943F030E9425:10081000950399E08E010F5F1F4FF801392F119258:100820003A95E9F799832A892A8391E09E8390E893:1008300098879AEF998720914E0130914F01275F59:100840003F4F3C832B838D83C7010E943F0349E0C8:1008500050E0B80180E00E944A030E9495037FC0E7:10086000C7012A8B0E943F032A89223241F482E287:1008700090E00E94430D892B09F071C074C02130B3:1008800069F488899989089711F420934B01809124:100890004B01811118C061EE70E01AC0233009F0DD:1008A00062C08C85882391F0823021F46CE08FEF58:1008B00090E006C0813009F056C06BE083EF90E015:1008C0000E94DB014AC06FEC70E002C06CE071E096:1008D0006115710509F447C0FB01449150E080E8BF:1008E0000E944A033CC0873009F43DC0883021F49F:1008F00081E08093F10033C0893089F5937099F5D8:10090000EBECF0E081E021E096E38093E9002093B6:10091000EB0034913093EC009093ED008F5F3196B3:10092000853099F78EE78093EA001092EA008C8573:100930008093500114C0888999890E943F038E8555:10094000811105C0CE010A960E94A80C06C0823013:1009500051F4CE010A960E946B0D882321F08EEF90:100960008093E80003C081E28093EB0062960FB6AB:10097000F894DEBF0FBECDBFDF91CF91FF91EF9115:10098000BF91AF919F918F917F916F915F914F91A7:100990003F912F911F910F91FF90EF900F900FBEFD:1009A0000F901F9018958093E9008091F2008823A2:1009B00019F08AE38093E80008951F920F920FB612:1009C0000F9211242F933F934F935F936F937F93D5:1009D0008F939F93AF93BF93EF93FF938091E10029:1009E0001092E10083FF0FC01092E90091E0909314:1009F000EB001092EC0092E39093ED001092500106:100A000098E09093F00082FF1DC083E00E94D30421:100A100080915201882339F0809152018150809356:100A20005201882369F080915101882359F0809107:100A30005101815080935101811104C0289A02C054:100A40005D9AF1CFFF91EF91BF91AF919F918F91FF:100A50007F916F915F914F913F912F910F900FBEBA:100A60000F901F9018951092500181E08093D7004D:100A700080EA8093D80082E189BD09B400FEFDCFF1:100A800061E070E080E090E00E94260980E98093B8:100A9000D8008CE08093E2001092E000559A209AF2:100AA00008952CE088E190E00FB6F894A895809323:100AB00060000FBE20936000FFCFDC01ED91FC9140:100AC0000190F081E02D099480915401909155019D:100AD00001969093550180935401883C91056CF0E8:100AE0008091530191E089278093530190E00E9407:100AF000850E109255011092540161E070E080E083:100B000090E00C94260988E10FB6F8948093600079:100B1000109260000FBE8091E8001092E80064E837:100B200073E080E090E00E9426098091E80080FF59:100B300004C081E08093000102C01092000162E0D5:100B400087E00E94E10986E591E00E94580760E78E:100B500070E086E591E00E946C076FEF70E086E53B:100B600091E00E945D0586E591E00E94810740E0EA:100B700066E08EE30E94A10640E062E08EE50E94FE:100B8000A10640E061E08FE50E94A10649E860E02F:100B900086E70E94A1064AEA62E086E70E94A10673:100BA0004AEA63E086E70E94A1064AEA64E086E733:100BB0000E94A1064AEA65E086E70E94A10644E198:100BC00063E486E70E94A10640E06CE086E70E94AD:100BD000A10640E06BE086E70E94A10640E06AE0E3:100BE00086E70E94A10640E06FE086E70E94A1062A:100BF00040E06EE086E70E94A10640E06DE086E7F7:100C00000E94A10640E062E186E70E94A10640E062:100C100061E186E70E94A10640E060E186E70E946C:100C2000A10640E065E186E70E94A10640E064E19C:100C300086E70E94A10640E063E186E70E94A106E4:100C400040E068E186E70E94A10640E067E186E7B0:100C50000E94A10640E066E186E70E94A1066DE3DE:100C600070E086E591E00E946C0761E070E086E547:100C700091E00E945D0560E070E086E591E00E94F1:100C80005D0560E070E086E591E00E945D0560E052:100C900070E086E591E00E945D0560E070E086E529:100CA00091E00E945D0560E070E086E591E00E94C1:100CB0005D0586E591E00E9481076DE370E086E5C1:100CC00091E00E946C0762E070E086E591E00E948E:100CD0005D0565E070E086E591E00E945D0560E0FD:100CE00070E086E591E00E945D0586E591E00E9456:100CF000810740E061E08EE60E94A10660E770E0B7:100D000086E591E00E946C0760E070E086E591E086:100D10000E945D0586E591E00E94810787E00E94C0:100D2000500A892B19F40E946405F8CF42E050E084:100D300061E575E084E00E94880780E090E00C9413:100D4000850E1F93CF93DF931F92CDB7DEB7162F7B:100D5000682F86E591E049830E946207612F86E54E:100D600091E00E9419074981642F86E591E00E9475:100D7000190786E591E00F90DF91CF911F910C94B8:100D800081078091860190E020918701821B910963:100D900008952091870180918601281750F4E22F51:100DA000F0E0E857FE4F808190E02F5F20938701AD:100DB00008958FEF9FEF0895E0918701809186015C:100DC000E81730F4F0E0E857FE4F808190E0089596:100DD0008FEF9FEF08950895CF92DF92EF92FF92E9:100DE0000F931F93CF93DF937C01CB018A01209156:100DF0006201222389F0EB016B01C40ED51ECC15D4:100E0000DD0569F06991D701ED91FC910190F081C8:100E1000E02DC7010995F3CF642F0E94EA0AC801AB:100E2000DF91CF911F910F91FF90EF90DF90CF90C6:100E30000895CF93DF931F92CDB7DEB769832091DA:100E400062012223D1F020916301203240F021E0A1:100E500030E0FC013383228380E090E015C0809174:100E60006401E82FF0E0EB59FE4F998190838F5F8A:100E7000809364018093630105C061E0CE01019617:100E80000E94EA0A81E090E00F90DF91CF910895EF:100E9000FC011382128248EE53E060E070E044836C:100EA0005583668377838FE091E0918380830895F3:100EB00010928701109286011092640110926301D2:100EC0000C94790A81E0809362016093850110920D:100ED00064011092630108950C9462070F93062F2A:100EE00021E04091630165E671E0809185010E94F7:100EF000970A1092640110926301109262010F919F:100F0000089561E00C946E0786E591E00C94480723:100F1000853008F04CC0E82FF0E0EE0FFF1FE855D9:100F2000FE4F718360838230E1F018F4813069F004:100F300004C0833019F1843071F1809169008C7F95:100F4000842B80936900E89A089580916900440F8A:100F5000551F440F551F837F842B80936900E99AA6:100F600008958091690034E0440F551F3A95E1F7E8:100F70008F7C842B80936900EA9A089580916900A0:100F800026E0440F551F2A95E1F78F73842B809339:100F90006900EB9A089580916A0094E0440F551F10:100FA0009A95E1F78F7C842B80936A00EE9A0895DE:100FB0001F920F920FB60F9211242F933F934F93CE:100FC0005F936F937F938F939F93AF93BF93EF93B1:100FD000FF938091A8019091A901892B29F0E091BC:100FE000A801F091A9010995FF91EF91BF91AF91EF:100FF0009F918F917F916F915F914F913F912F9131:101000000F900FBE0F901F9018951F920F920FB662:101010000F9211242F933F934F935F936F937F937E:101020008F939F93AF93BF93EF93FF938091AA0108:101030009091AB01892B29F0E091AA01F091AB01CD:101040000995FF91EF91BF91AF919F918F917F9102:101050006F915F914F913F912F910F900FBE0F9025:101060001F9018951F920F920FB60F9211242F9375:101070003F934F935F936F937F938F939F93AF9320:10108000BF93EF93FF938091AC019091AD01892BB9:1010900029F0E091AC01F091AD010995FF91EF913C:1010A000BF91AF919F918F917F916F915F914F9180:1010B0003F912F910F900FBE0F901F9018951F9288:1010C0000F920FB60F9211242F933F934F935F937C:1010D0006F937F938F939F93AF93BF93EF93FF9300:1010E0008091AE019091AF01892B29F0E091AE0182:1010F000F091AF010995FF91EF91BF91AF919F9151:101100008F917F916F915F914F913F912F910F90B0:101110000FBE0F901F9018951F920F920FB60F924F:1011200011242F933F934F935F936F937F938F93EC:101130009F93AF93BF93EF93FF938091B0019091F2:10114000B101892B29F0E091B001F091B10109952D:10115000FF91EF91BF91AF919F918F917F916F918F:101160005F914F913F912F910F900FBE0F901F9065:1011700018951F920F920FB60F9211242F933F9341:101180008F939F93AF93BF938091B3019091B401DC:10119000A091B501B091B6013091B20123E0230FC7:1011A0002D3720F40196A11DB11D05C026E8230F9F:1011B0000296A11DB11D2093B2018093B3019093BB:1011C000B401A093B501B093B6018091B70190919D:1011D000B801A091B901B091BA010196A11DB11D4C:1011E0008093B7019093B801A093B901B093BA016D:1011F000BF91AF919F918F913F912F910F900FBE13:101200000F901F9018953FB7F8948091B701909177:10121000B801A091B901B091BA0126B5A89B05C04B:101220002F3F19F00196A11DB11D3FBF6627782FF2:10123000892F9A2F620F711D811D911D42E0660F4B:10124000771F881F991F4A95D1F70895CF92DF9293:10125000EF92FF92CF93DF936B017C010E94030911:10126000EB01C114D104E104F10489F00E94900E55:101270000E9403096C1B7D0B683E734090F381E074:10128000C81AD108E108F108C851DC4FEACFDF9154:10129000CF91FF90EF90DF90CF900895789484B530:1012A000826084BD84B5816084BD85B5826085BD62:1012B00085B5816085BDEEE6F0E080818160808348:1012C000E1E8F0E01082808182608083808181602B:1012D0008083E0E8F0E0808181608083E1E9F0E0F4:1012E000808182608083808181608083E0E9F0E09A:1012F000808181608083E1ECF0E080818460808384:10130000808182608083808181608083E3ECF0E073:10131000808181608083E0ECF0E080818260808366:10132000E2ECF0E0808181608083EAE7F0E0808198:1013300084608083808182608083808181608083FB:10134000808180688083089590E0FC013197EF30C0:10135000F105B0F5EA5AFF4F0C941C108091800003:101360008F7703C0809180008F7D809380000895E7:1013700080918000877FF9CF84B58F7702C084B5D4:101380008F7D84BD0895809190008F7707C08091F4:1013900090008F7D03C080919000877F80939000A4:1013A00008958091C0008F7703C08091C0008F7D29:1013B0008093C00008958091C200877F8093C2000F:1013C0000895CF93DF9390E0FC01E25DFE4F2491FE:1013D000FC01E45BFE4F8491882349F190E0880F83:1013E000991FFC01EA57FE4FA591B49188589E4F72:1013F000FC01C591D4919FB7611108C0F8948C91FC:10140000209582238C93888182230AC0623051F414:10141000F8948C91322F309583238C938881822B82:10142000888304C0F8948C91822B8C939FBFDF91AA:10143000CF9108950F931F93CF93DF931F92CDB752:10144000DEB7282F30E0F901E05FFE4F8491F9010B:10145000E25DFE4F1491F901E45BFE4F049100231D:10146000C9F0882321F069830E94A4096981E02FD3:10147000F0E0EE0FFF1FE858FE4FA591B4919FB723:10148000F8948C91611103C01095812301C0812BC8:101490008C939FBF0F90DF91CF911F910F91089573:1014A000CF93DF93282F30E0F901E05FFE4F849166:1014B000F901E25DFE4FD491F901E45BFE4FC49166:1014C000CC2391F081110E94A409EC2FF0E0EE0FE3:1014D000FF1FE659FE4FA591B4912C912D2381E079:1014E00090E021F480E002C080E090E0DF91CF91B5:1014F00008951092280281E080932602109225021E:1015000061E082E00E941A0A61E083E00E941A0A08:10151000E9EBF0E080818E7F808380818D7F808306:1015200088E48093B80085E48093BC0008950F930D:10153000413208F046C0909128029111FCCF92E010:1015400090932802009326029FEF9093BB01109284:1015500000024093FF01FB0161E072E0DB019A2F82:10156000961B941718F491919D93F9CF109227022E:1015700090912702880F892B809327028091250262:10158000813041F410922502809127028093BB00A4:1015900085EC01C085EE8093BC00222321F0809170:1015A00028028230E1F38091BB018F3F61F080918E:1015B000BB01803251F08091BB01803341F483E064:1015C00007C081E005C080E003C082E001C084E084:1015D0000F910895613298F420912802243089F403:1015E0006093DD01FC018FED91E0DC012A2F281BC7:1015F000261718F421912D93F9CF80E0089581E00A:10160000089582E0089585ED8093BC008091BC0030:1016100084FDFCCF10922802089585EC8093BC00D5:101620001092280208951F920F920FB60F92112464:101630002F933F934F935F936F937F938F939F93DA:10164000AF93BF93EF93FF938091B900887F80366B:1016500009F49CC068F5883209F45BC090F48031CD:1016600009F454C038F4882309F4F5C0883009F42B:101670004DC0F5C0883109F44CC0803209F45DC01A:10168000EEC0803409F468C048F4803309F455C0D2:10169000883309F0E4C08093BB01A8C0803509F409:1016A0004FC0883509F45DC0883409F0D8C0D5C072:1016B000883909F4C6C0A8F4883709F467C038F43B:1016C000883609F463C0803709F460C0C8C0883820:1016D00009F4B7C0803909F45FC0803809F0BFC091:1016E0005BC0803B09F485C038F4803A09F466C0D9:1016F000883A09F47EC0B3C0803C09F4A6C0883C97:1017000009F4A3C0883B09F489C0A9C080912702CD:1017100010C0909100028091FF01981770F5E09140:10172000000281E08E0F80930002F0E0EF5FFD4F3A:1017300080818093BB0085EC85C08093BB018DC008:10174000E091000281E08E0F809300028091BB0047:10175000F0E0EF5FFD4F8083909100028091FF01E8:101760006DC0E091000281E08E0F809300028091B5:10177000BB00F0E0EF5FFD4F808380912602811176:101780006CC081E08093250284EA60C083E080938E:1017900028021092BC01CFCF8091BC01803208F0AA:1017A00050C0E091BC0181E08E0F8093BC0180911C:1017B000BB00F0E0E354FE4F8083BDCF8091BC01BD:1017C000803230F4E091BC01F0E0E354FE4F10822F:1017D0000E94030B6091BC0170E0E0912102F09146:1017E00022028DEB91E009951092BC010E940D0B35:1017F00036C084E0809328021092DE011092DD0151:10180000E0912302F091240209958091DD0181117C:1018100005C081E08093DD011092DF01E091DE01DF:1018200081E08E0F8093DE01F0E0E152FE4F808177:101830008093BB009091DE018091DD01981708F440:101840007ACF85E88093BC000AC085EC8093BC0009:101850001092280204C01092BB010E94030BFF915A:10186000EF91BF91AF919F918F917F916F915F9118:101870004F913F912F910F900FBE0F901F90189591:10188000CF93DF931F92CDB7DEB76983DC01ED9173:10189000FC910280F381E02D41E050E0BE016F5FDA:1018A0007F4F09950F90DF91CF910895CF93DF93EC:1018B000EC018C859D8597FF05C082E00E947E0229:1018C0009D878C878C859D85DF91CF91089583E0DE:1018D0000C94D304FC018485958597FD06C082E0B5:1018E0000E94260290E00196089582E00E9426025E:1018F00090E00895FC018485958597FD05C02FEF44:101900003FEF35872487089582E00C947E02CF93C1:10191000DF93EC0180910801882331F083E00E947D:10192000AF021816190634F081E090E09B838A8399:1019300080E090E0DF91CF910895FC0120812E5F3F:10194000208342E450E064E971E080E80C944A03AB:10195000FC0181819081913A59F4813209F03CC0B7:1019600047E050E061E071E080E00E944A0343C03C:10197000913291F5803239F467E070E081E091E0D6:101980000E947B0306C0823209F035C082818093B9:1019900008018091010190910201A0910301B09191:1019A0000401803B9440A105B105C1F48091080178:1019B00080FD14C087E797E79093010880930008A3:1019C0002BE088E190E00FB6F894A8958093600032:1019D0000FBE209360000FC080E0089588E10FB62D:1019E000F89480936000109260000FBEA89510924A:1019F00001081092000881E0089510922C021092C4:101A00002B0288EE93E0A0E0B0E080932D0290934B:101A10002E02A0932F02B09330028FE191E09093B9:101A20002A02809329028FEF9FEF909336028093D2:101A300035020895FF920F931F93CF93DF93EC012C:101A4000F62EE881F9810480F581E02D09958C015D:101A5000E881F9810680F781E02D6F2DCE0109958F:101A6000C8019927DF91CF911F910F91FF900895A1:101A7000FC0120812F5F208349E150E066E572E0A0:101A800080E80C944A0345E650E06FE672E080E897:101A90000C944A03EF92FF920F931F93CF93DF931F:101AA0001F92CDB7DEB789838B017A0141E050E008:101AB000BE016F5F7F4F84E00E94AF02A701B801B3:101AC00084E40E94AF020F90DF91CF911F910F919C:101AD000FF90EF900895FC0191818081813A31F46B:101AE00081E0913091F0933089F411C0813271F42A:101AF0009B3021F4828180930A0105C09A3031F431:101B000082818093090181E00895089580E008951D:101B100048E050E082E00C944A0DCF93DF93DC0163:101B2000683818F0E8E7E60F25C0E62FF0E067FF19:101B300011C0E058F10981E090E001C0880FEA95FA:101B4000EAF714969C911497982B14969C931497EB:101B5000E0E010C0EA52FE4FE491EE2309F440C0E9:101B6000E7FF08C014968C911497826014968C93AA:101B70001497EF7716968C9116978E1741F117965A:101B80008C9117978E1719F118968C9118978E17BC:101B9000F1F019968C9119978E17C9F01A968C91BD:101BA0001A978E17A1F01B968C911B978E1779F0C0:101BB00080E090E0ED01C80FD91F2E81211102C0F5:101BC000EE8305C0019686309105A1F709C0BD01DD:101BD0006C5F7F4FCD010E94880D81E090E008C0CE:101BE00081E090E013969C938E93129780E090E0B2:101BF000DF91CF910895683818F0E8E7E60F25C027:101C0000E62FF0E067FF12C0E058F10921E030E074:101C100001C0220FEA95EAF72095DC0114963C9169:101C20001497322314963C93E0E00FC0EA52FE4F23:101C3000E491EE2329F1E7FF08C0DC0114962C9112:101C400014972D7F14962C93EF7720E030E0EE234D:101C500051F0DC01A20FB31F16964C9116974E134C:101C600002C016961C922F5F3F4F2630310579F740:101C7000BC016C5F7F4F0E94880D81E090E0089569:101C800080E090E00895FC0116821782108611868C:101C9000128613861482BC016C5F7F4F0C94880DF2:101CA0001092850210927C0210927B028FE291E0EA:101CB00090937A02809379020895CF92DF92EF9207:101CC000FF920F931F93CF93DF936C017A01EB0187:101CD000E60EF71E00E010E0CE15DF0561F0699119:101CE000D601ED91FC910190F081E02DC60109959E:101CF000080F191FF1CFC801DF91CF911F910F91EC:101D0000FF90EF90DF90CF900895CF93C82F61E0C0:101D10008DE00E94E1096C2F8DE0CF910C941A0A9E:101D200008951F920F920FB60F9211242F938F9345:101D30009F93EF93FF93E0919602F0919702808139:101D4000E0919C02F0919D0282FD12C090818091F1:101D50009F028F5F8F732091A002821751F0E09154:101D60009F02F0E0EA57FD4F958F80939F0201C0DC:101D70008081FF91EF919F918F912F910F900FBED6:101D80000F901F9018951F920F920FB60F9211246B:101D90002F933F934F935F936F937F938F939F9373:101DA000AF93BF93EF93FF9386E892E00E94710F89:101DB000FF91EF91BF91AF919F918F917F916F9123:101DC0005F914F913F912F910F900FBE0F901F90F9:101DD000189586E892E00E94360F21E0892B09F4DD:101DE00020E0822F0895109289021092880288EED6:101DF00093E0A0E0B0E080938A0290938B02A093DE:101E00008C02B0938D028DE391E0909387028093D2:101E100086028DEC90E090939302809392028CEC7A:101E200090E0909395028093940288EC90E09093D8:101E300097028093960289EC90E0909399028093A8:101E400098028AEC90E090939B0280939A028EEC29:101E500090E090939D0280939C0210929F021092BA:101E6000A0021092A1021092A2020895FC01818D9D:101E7000228D90E0805C9F4F821B91098F73992780:101E80000895FC01918D828D981731F0828DE80FB5:101E9000F11D858D90E008958FEF9FEF0895FC016F:101EA000918D828D981761F0828DDF01A80FB11D91:101EB0005D968C91928D9F5F9F73928F90E00895B5:101EC0008FEF9FEF089589EE9EE0892B49F080E027:101ED00090E0892B29F00E94E90E81110C940000FA:101EE0000895FC01848DDF01A80FB11DA35ABF4FD7:101EF0002C91848D90E001968F739927848FA68909:101F0000B7892C93A089B1898C9180648C93938D2F:101F1000848D981306C00288F389E02D80818F7D1F:101F200080830895CF93DF93EC01888D8823C9F0D7:101F3000EA89FB89808185FD05C0A889B9898C91D2:101F400086FD0FC00FB607FCF5CF808185FFF2CF6D:101F5000A889B9898C9185FFEDCFCE010E94710FC0:101F6000E7CFDF91CF910895CF92DF92FF920F9349:101F70001F93CF93DF931F92CDB7DEB76C01DC01C7:101F80005B969C915B975C968C915C97981307C0CD:101F90005096ED91FC915197808185FD32C0F601FC:101FA000038D10E00F5F1F4F0F731127F02EF60106:101FB000848DF81211C00FB607FCF9CFD6015096E8:101FC000ED91FC915197808185FFF1CFC601698326:101FD0000E94710F6981EBCF838DE80FF11DE35AE9:101FE000FF4F6083D6015B960C935B975296ED9101:101FF000FC91539780818062808381E058968C9316:102000000DC0D6015696ED91FC915797608350967E:10201000ED91FC91519780818064808381E090E014:102020000F90DF91CF911F910F91FF90DF90CF9094:102030000895F8940C942210EE0FFF1F0590F49170:08204000E02D0994F894FFCF94:102048000100E1000000000000010100000000198B:1020580007EC06C106C906DC06EB060000000040D6:102068000C870C6A0C7A0C560C670C000000001ADE:102078000D5D0E8D0DFB0D430E00000000B40F5DCD:0A2088000E360F4F0F410F920F00AC:00000001FF"

var time_modal = 3000;
function closeModal() {
    $('#Barra-pop').foundation('reveal', 'close');
    $("#status_var").text(texts_array[1]); //cambia el letrero
}

function OpenModal(){
    $("#alert-message").text(""); //resetea el mensaje de error
    $('#Barra-pop').foundation('reveal', 'open');  //abre el pop donde salen los errores y la barra de cargando
    $('#Barra-pop').data('revealInit').close_on_background_click = false;
    $('#Barra-pop').data('revealInit').close_on_esc = false;
}

//variable para saltarnos la eleccion entre windows y mac para cuando queremos recuperar el briko
var selector_reset = false;
//variable para correr el intervalo que pide la informacion
var interval_var;
//variable para el intervalo que nos avisa si ya acabo o no de cargar el codigo
var interval_var2;
//variable para el intervalo que nos avisa que no hay nada en la base de datos
var interval_var3;
//variable de seguridad por si no encuentra la data despues de 10 intentos
var contador_timer = 0;
//variable de seguridad por si no encuentra se logra compilar despues de 10 intentos
var contador_timer2 = 0;
//variable de seguridad por si hay muchas cosas en la base de datos y no puede eliminarlas en 10 intentos
var contador_timer3 = 0;
// The ID of the extension we want to talk to.
var editorExtensionId = "glbpaclcjfijbmoldemepbimeaendelj";//"gcfkfapjkkjeocbjmnocphnljfncligl";  //id de la extension de chorme
//variable para saber si apenas se instalo el software
var boolean_state_app = false;

///boton para buscar los puertos conectados
$("#button_search").on("click",function(){  //pide los puertos
if(boolean_state_app==true){
   $("#alert-message").text(texts_array[0]); //resetea el mensaje de error
   $("#status_var").text("Error");
   setTimeout(closeModal, time_modal);
}else{
if($("#status_var").text() != texts_array[1]){ //si esta siendo reseteado o esta ya cargando un codigo
$("#alert-message").text(texts_array[2]); //resetea el mensaje de error
setTimeout(closeModal, time_modal);
}else{
$('#port_picker').empty(); //borra lo que hay en el select
$("#status_var").text(texts_array[3]);
//manda un json a la pagina y recibe una respuesta (response)
chrome.runtime.sendMessage(editorExtensionId, {action: "generateports"},
function(response) {
//no regresa nada
});
setTimeout(function(){
chrome.runtime.sendMessage(editorExtensionId, {action: "portsearch"},
  function(response) { //regresa un json con un arreglo con los puertos
    if(typeof response !== 'undefined'){ //solo si hay data
     for (var i = 0; i < response.ports.length; i++) {
            $('#port_picker').append('<option value="' + response.ports[i].name + '">' + response.ports[i].name + '</option>');
        }
    }
  });
$("#status_var").text(texts_array[1]);
},1000);
}
}
});

///boton para buscar los puertos conectados
$("#button_reset").on("click",function(){  //pide los puertos
OpenModal();
if(boolean_state_app==true){
    $("#alert-message").text(texts_array[0]); //resetea el mensaje de error
    $("#status_var").text("Error");
    setTimeout(closeModal, time_modal);
}else{
if($("#status_var").text() != texts_array[1]){ //si esta siendo reseteado o esta ya cargando un codigo
$("#alert-message").text(texts_array[2]); //resetea el mensaje de error
setTimeout(closeModal, time_modal);
}else{
$("#status_var").text(texts_array[4]);
var ports = $('#port_picker').val() ;
if(ports == "" || ports === null){
    $("#alert-message").text(texts_array[5]);
    $("#status_var").text("Error");
    setTimeout(closeModal, time_modal);
}else{
progressBar(30, $('#progressBar'));
//manda un json a la pagina y recibe una respuesta (response)
chrome.runtime.sendMessage(editorExtensionId, {action: "reset", data:ports},
function(response) {
//no regresa nada
});
setTimeout(function(){
progressBar(60, $('#progressBar'));
setTimeout(function(){
progressBar(80, $('#progressBar'));
setTimeout(function(){
setTimeout(closeModal, time_modal);
$("#status_var").text(texts_array[7]);
$("#alert-message").html(texts_array[8]); //resetea el mensaje de error
progressBar(0, $('#progressBar'));
},3000); //en total deben ser 10 segundos en los 3 timeouts
},3000);
},4000);
}
}
}
});

///boton para buscar los puertos conectados
$("#button_load").on("click",function(){  //pide los puertos
if(boolean_state_app==true){
    $("#alert-message").text(texts_array[0]); //resetea el mensaje de error
    $("#status_var").text("Error");
    setTimeout(closeModal, time_modal);
}else{
if($("#status_var").text() != texts_array[1]){ //si esta siendo reseteado o esta ya cargando un codigo
$("#alert-message").text(texts_array[2]); //resetea el mensaje de error
setTimeout(closeModal, time_modal);
}else{
var ports = $('#port_picker').val() ;
if(ports == "" || ports === null){
$("#alert-message").text(texts_array[5]);
$("#status_var").text("Error");
setTimeout(closeModal, time_modal);
}else{
selector_reset = false;
$("#status_var").text(texts_array[6]);
progressBar(30, $('#progressBar'));
//checa que no haya data en la base de datos antes de mandar
interval_var3 = setInterval(function(){ Check_nodata_left(); }, 5000); //activa el intervalo del get hasta que tenga la data cada 2 segundos
}
}
}
});

///boton para buscar los puertos conectados
$("#recover_briko").on("click",function(){  //pide los puertos
OpenModal();
if(boolean_state_app==true){
    $("#alert-message").text(texts_array[0]); //resetea el mensaje de error
    $("#status_var").text("Error");
    setTimeout(closeModal, time_modal);
}else{
if($("#status_var").text() != texts_array[1]){ //si esta siendo reseteado o esta ya cargando un codigo
$("#alert-message").text(texts_array[2]); //resetea el mensaje de error
setTimeout(closeModal, time_modal);
}else{
var ports = $('#port_picker').val() ;
if(ports == "" || ports === null){
  $("#alert-message").text(texts_array[5]);
$("#status_var").text("Error");
setTimeout(closeModal, time_modal);
}else{
selector_reset = true;
$("#status_var").text(texts_array[6]);
progressBar(20, $('#progressBar'));
//checa que no haya data en la base de datos antes de mandar
Load_base_code(); //carga un codigo vacio
}
}
}
});

function Post_2_server(code){  //pide los puertos
                //var url1 ="http://192.168.2.71:2113/codeblocks";
                var url1 ="http://107.170.201.93:80/codeblocks";
                //var url1 ="http://localhost/brikorep/index.php/codepost";
                var id_user = Id_user;
                var access_key = "jdt579sr6h4fbs79sf2hjd6792GT6j";
        $(function ()
          {
            //-----------------------------------------------------------------------
            // 2) Send a http request with AJAX http://api.jquery.com/jQuery.ajax/
            //-----------------------------------------------------------------------
            $.ajax({
              url: url1,                  //the script to call to get data
              data:access_key+"#"+id_user+"#"+code, //you can insert url argumnets here to pass to api.php
                      //data: "id_user="+id_user+"&code="+code+"&status="+id_user,
              type: "post",                                 //for example "id=5&parent=6"
                      cache: false,
              //dataType: 'json',                //data format
              success: function(msg){
                          interval_var = setInterval(function(){ getdatafun(); }, 2000); //activa el intervalo del get hasta que tenga la data cada 2 segundos
                       },
                      error: function(XMLHttpRequest, textStatus, errorThrown) {
                          $("#alert-message").text(texts_array[9]); //resetea el mensaje de error
                          $("#status_var").text("Error");
                          setTimeout(closeModal, time_modal);
                          progressBar(0, $('#progressBar'));
                        }
            });
          });
};

function getdatafun(){
//trae el codigo compilado
contador_timer++;  //incrementa una la contador (por si hace muchs request y no hay data que pare)
if(contador_timer>10){
clearInterval(interval_var); //para el inetervalo
contador_timer = 0;
$("#alert-message").text(texts_array[10]); //resetea el mensaje de error
$("#status_var").text("Error"); //cambia el letrero
setTimeout(closeModal, time_modal);
progressBar(0, $('#progressBar'));
}else{
 $.ajax({
     type: 'GET',
     cache: false,
     url: "http://briko.cc/codecompile/"+Id_user,
     success: function(data) { //si hace con exito el get
          if(data !="[]" ){ //solo si se completo el http post del servidor
              contador_timer = 0;
              clearInterval(interval_var); //para el inetervalo
              var opsystem = Opsys; //guarda si es windows o mac
              var obj = jQuery.parseJSON( data );
              //console.log(obj);
              //console.log(obj[0].Status);
              //console.log(obj[0].Code);
              //console.log(obj[0].ID_user);
              if(obj[0].Status == "0"){ //si no hubo error al compilar
              var ports = $('#port_picker').val() ; //lee otra vez el puerto
              $("#status_var").text(texts_array[11]);
              progressBar(60, $('#progressBar'));
              //recetea
              chrome.runtime.sendMessage(editorExtensionId, {action: "reset", data:ports},
              function(response) {
                  //no regresa nada
              });
              setTimeout(function(){
              if(opsystem == "Windows" && selector_reset  == false){ //si es windows busca el nuevo puerto
              ///genera los puertos otra vez
              chrome.runtime.sendMessage(editorExtensionId, {action: "generateports"},
              function(response) {
               //no regresa nada
                });
              //busca el com nuevo que aparecio (el com del bootloader)
              setTimeout(function(){
              chrome.runtime.sendMessage(editorExtensionId, {action: "portsearch"},
              function(response) { //regresa un json con un arreglo con los puertos
                    if(typeof response !== 'undefined'){ //solo si hay data
                    var xselect = document.getElementById("port_picker");
                    var flag_ss = 0;
                    var flag_ss2 = 0;
                    for (var i = 0; i < response.ports.length; i++) { //compara todos los nuevos
                    //for (var i = 0; i < 1; i++) { //compara solo el primer nuevo
                        if(flag_ss2 == 0){
                        for (var j = 0; j < xselect.length; j++) {
                            if(xselect.options[j].value != response.ports[i].name){
                                flag_ss = 1;
                            }else{flag_ss = 0;} //solo si es diferente a todos los que habia
                        }
                          if(flag_ss==1){ flag_ss2 = 1; }
                        }
                        if(flag_ss2==1){
                            ports = response.ports[i].name;
                        }
                    }
                    }
                });
                setTimeout(function(){
                //manda un json a la pagina y recibe una respuesta (response)
                chrome.runtime.sendMessage(editorExtensionId, {action: "load", data:ports,data2:obj[0].Code},
                function(response) {
                if(typeof response !== 'undefined'){ //solo si hay data
                if(response.status == "ok"){
                    interval_var2 = setInterval(function(){ Ask_compilation_complete(); }, 2000); //activa el intervalo del checar si ya acbo de compilar hasta que tenga la data cada 2 segundos
                }else{
                    $("#alert-message").text(texts_array[15]); //resetea el mensaje de error
                    $("#status_var").text("Error");
                    setTimeout(closeModal, time_modal);
                    progressBar(0, $('#progressBar'));
                }
                }
                });
                },500); //500 milis despues carga el programa
                },1000); //despues de 1 segundo pide los puertos
                } else {  //mac o linux hace esto
                 setTimeout(function(){
                //manda un json a la pagina y recibe una respuesta (response)
                chrome.runtime.sendMessage(editorExtensionId, {action: "load", data:ports,data2:obj[0].Code},
                function(response) {
                if(typeof response !== 'undefined'){ //solo si hay data
                if(response.status == "ok"){
                    interval_var2 = setInterval(function(){ Ask_compilation_complete(); }, 2000); //activa el intervalo del checar si ya acbo de compilar hasta que tenga la data cada 2 segundos
                }else{
                    $("#alert-message").text(texts_array[15]); //resetea el mensaje de error
                    $("#status_var").text("Error");
                    setTimeout(closeModal, time_modal);
                    progressBar(0, $('#progressBar'));
                }
                }
                });
                },500); //500 milis despues carga el programa
                }
                },5000); //despues de 500 milis del reset hace refresh de los puertos
                }else{
                $("#alert-message").text(texts_array[15]); //resetea el mensaje de error
                $("#status_var").text("Error");
                setTimeout(closeModal, time_modal);
                progressBar(0, $('#progressBar'));
                }
                }else{}  //deja que el interval siga pidiendo la data
    }
});
}
}

function Ask_compilation_complete(){
 contador_timer2++;
progressBar(80, $('#progressBar'));
 if(contador_timer2 > 10){
     contador_timer2 = 0;
     clearInterval(interval_var2); //para el inetervalo2
     $("#alert-message").text(texts_array[21]); //resetea el mensaje de error
     $("#status_var").text("Error"); //cambia el letrero
     setTimeout(closeModal, time_modal);
     progressBar(0, $('#progressBar'));
}else{
 //manda un json a la pagina y recibe una respuesta (response)
chrome.runtime.sendMessage(editorExtensionId, {action: "compilationstatus"},
function(response) {
    if(typeof response !== 'undefined'){ //solo si hay data
     if(response.status == "ok") {
            contador_timer2 = 0;
            clearInterval(interval_var2); //para el inetervalo2
            setTimeout(closeModal, time_modal);
             $("#alert-message").html(texts_array[13]); //resetea el mensaje de error
            $("#status_var").text(texts_array[12]); //cambia el letrero
            progressBar(0, $('#progressBar'));
        }else{} //sigue corriendo el intervalo hasta que se acabe la compilacion
    }
});
}
}

function Check_nodata_left(){
//borra cualquier data que haya en la base de datos
contador_timer3++;  //incrementa una la contador (por si hace muchs request y no hay data que pare)
if(contador_timer3>5){
clearInterval(interval_var3); //para el inetervalo
contador_timer3 = 0;
$("#alert-message").text(texts_array[14]); //resetea el mensaje de error
$("#status_var").text("Error"); //cambia el letrero
setTimeout(closeModal, time_modal);
progressBar(0, $('#progressBar'));
}else{
 $.ajax({
     type: 'GET',
     cache: false,
     url: "http://briko.cc/codecompile/"+Id_user,
     success: function(data) { //si hace con exito el get
          if(data =="[]" ){ //solo si se completo el http post del servidor
              contador_timer3 = 0;
              clearInterval(interval_var3); //para el inetervalo
              var code = $("#content_brikode").val();
              Post_2_server(code); //hace el post al servidor
          }
     }
});
}
}

function Load_base_code(){
var ports = $('#port_picker').val() ; //lee otra vez el puerto
$("#status_var").text(texts_array[11]);
progressBar(60, $('#progressBar'));
//recetea
chrome.runtime.sendMessage(editorExtensionId, {action: "reset", data:ports},
    function(response) {
            //no regresa nada
    });
setTimeout(function(){
    //manda un json a la pagina y recibe una respuesta (response)
    chrome.runtime.sendMessage(editorExtensionId, {action: "load", data:ports,data2:hex_codigo_vacio},
        function(response) {
            if(typeof response !== 'undefined'){ //solo si hay data
            if(response.status == "ok"){
                    interval_var2 = setInterval(function(){ Ask_compilation_complete(); }, 2000); //activa el intervalo del checar si ya acbo de compilar hasta que tenga la data cada 2 segundos
            }else{
                $("#alert-message").text(texts_array[15]); //resetea el mensaje de error
                $("#status_var").text("Error");
                setTimeout(closeModal, time_modal);
                progressBar(0, $('#progressBar'));
            }
            }
        });
},1000); //500 milis despues carga el programa

}


//cuando la pagina esta lista, activa el pluggin the chrome (osea crea la venta principal que hace todo)
$(document).ready(function() {
//manda un json a la pagina y recibe una respuesta (response)
chrome.runtime.sendMessage(editorExtensionId, {action: "activate_app"},
function(response) {
if(typeof response !== 'undefined'){ //solo si hay data
     if(response.status == "ok"){
         if(response.rev != "1.2.1"){
        $("#install-button").html(texts_array[20]);
        document.getElementById('install-button').style.display = 'none';  //quita el boton de abrir la app si la encontro
        OpenModal();
        $("#alert-message").text(texts_array[16]); //resetea el mensaje de error
        $("#status_var").text("Error");
        setTimeout(closeModal, time_modal);
         boolean_state_app = true;
         }else{
        document.getElementById('install-button').style.display = 'none';  //quita el boton de abrir la app si la encontro
        boolean_state_app = false;
         }
      }
      }else{
        OpenModal();
        $("#alert-message").text(texts_array[17]); //resetea el mensaje de error
        $("#status_var").text("Error");
        setTimeout(closeModal, time_modal);
        boolean_state_app = true;
}
});
});

//para detectar que la ventana se cerro
$(window).unload(function() {
//manda un json a la pagina y recibe una respuesta (response)
chrome.runtime.sendMessage(editorExtensionId, {action: "disable_app"},
function(response) {
//no regresa nada
});
});

//para hacer que si cambia de tab mientras esta cargando lo detenga
var visibilityChange = (function (window) {
    var inView = false;
    return function (fn) {
        window.onfocus = window.onblur = window.onpageshow = window.onpagehide = function (e) {
            if ({focus:1, pageshow:1}[e.type]) {
                if (inView) return;
                fn("visible");
                inView = true;
            } else{
                fn("hidden");
                inView = false;
            }
        };
    };
}(this));

visibilityChange(function (state) {  //visible   hidden
    if( (state == 'hidden') && ($("#status_var").text()!= texts_array[1]) && ($("#status_var").text()!= 'Error') ){
        alert(texts_array[18]);
    }
});

//para detectar antes de que la ventana se cierre
window.onbeforeunload = function() {
    if(($("#status_var").text()!= texts_array[1]) && ($("#status_var").text()!= 'Error') ){
        return texts_array[19];
    }
 };


window.nativeAlert = window.alert;
window.alert = function (message) {
var timeBefore = new Date();
var confirmBool = nativeAlert(message);
var timeAfter = new Date();
if ((timeAfter - timeBefore) < 350) {
    $("#display_alert_disablem").trigger("click");  //forza el onclick del button invisible que esta en blockscode4
  }
}

window.nativeConfirm = window.confirm;
window.confirm = function (message) {
var timeBefore = new Date();
var confirmBool = nativeConfirm(message);
var timeAfter = new Date();
if ((timeAfter - timeBefore) < 350) {
    $("#display_alert_disablem").trigger("click");  //forza el onclick del button invisible que esta en blockscode4
}
 return confirmBool;
}

